$(function(){function check_repetition(a,b){var c="";for(i=0;i<b.length;i++){repeated=true;for(j=0;j<a&&(j+i+a)<b.length;j++){repeated=repeated&&(b.charAt(j+i)==b.charAt(j+i+a))}if(j<a){repeated=false}if(repeated){i+=a-1;repeated=false}else{c+=b.charAt(i)}}return c}function pass_strenght(a){var b=0;if(a.length<6||!(/\d/.test(a))){return 0}b+=(a.length-6)*4;b+=(check_repetition(1,a).length-a.length)*1;b+=(check_repetition(2,a).length-a.length)*1;b+=(check_repetition(3,a).length-a.length)*1;b+=(check_repetition(4,a).length-a.length)*1;if(a.match(/(.*[0-9].*[0-9].*[0-9])/)){b+=5}if(a.match(/(.*[!,@,#,$,%,^,&,*,?,_,~].*[!,@,#,$,%,^,&,*,?,_,~])/)){b+=5}if(a.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)){b+=7}if(a.match(/([a-zA-Z])/)&&a.match(/([0-9])/)){b+=10}if(a.match(/([!,@,#,$,%,^,&,*,?,_,~])/)&&a.match(/([0-9])/)){b+=10}if(a.match(/([!,@,#,$,%,^,&,*,?,_,~])/)&&a.match(/([a-zA-Z])/)){b+=10}if(a.match(/^\w+$/)||a.match(/^\d+$/)){b-=10}if(b>100){return 100}if(b<0){return 0}return(b)}function validate_form(){var a='<?php echo $comp_img; ?>',state=$('#state').val();if($('#user_result').html()===a&&$('#pass_result').html()===a&&$('#passconf_result').html()===a&&$('#email_result').html()===a&&state!=''&&state){$('#submit').removeAttr('disabled')}}loading='<?php echo img($loading); ?>';if($('#country').val()===''){$('#state').attr('disabled',true)}$('#submit').attr('disabled',true);$('input').focus(function(){if($(this).attr('type')!='submit'){$('#submit').attr('disabled',true)}$('#user_notes').html('');$('#email_notes').html('')});$('input').bind('blur keyup',function(){var b=$('input[name=MP_csrf]').val(),name=$(this).attr('name'),value=$(this).val(),correct_img='<?php echo img($correct); ?>',wrong_img='<?php echo img($wrong); ?>';switch(name){case'username':$('#user_notes').html(loading);$.post("<?php echo site_url('registration/request'); ?>",{MP_csrf:b,name:name,value:value},function(a){if(a!=correct_img){$('#user_notes').html(a);$('#user_result').html(wrong_img)}else{$('#user_notes').html('');$('#user_result').html(a)}});validate_form();break;case'password':$('#pass_result').html(loading);$('#passconf_result').html(loading);var c=$('#pass_conf').val(),username=$('#username').val();$('#percent').width(pass_strenght(value)+'%');if(value.toLowerCase()==username.toLowerCase()||pass_strenght(value)==0){$('#pass_result').html(wrong_img)}else{$('#pass_result').html(correct_img)}if(value===c&&d){$('#passconf_result').html(correct_img)}else{$('#passconf_result').html(wrong_img)}validate_form();break;case'passconf':$('#pass_result').html(loading);$('#passconf_result').html(loading);var d=$('#password').val(),username=$('#username').val();if(d.toLowerCase()==username.toLowerCase()||pass_strenght(d)==0){$('#pass_result').html(wrong_img)}else{$('#pass_result').html(correct_img)}if(d===value&&d){$('#passconf_result').html(correct_img)}else{$('#passconf_result').html(wrong_img)}validate_form();break;case'email':$('#email_notes').html(loading);var e=new RegExp(/^(("[\w-\s]+")|([\w-]+(?:\.[\w-]+)*)|("[\w-\s]+")([\w-]+(?:\.[\w-]+)*))(@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i);if(e.test(value)&&value!=''){$.post("<?php echo site_url('registration/request'); ?>",{MP_csrf:b,name:name,value:value},function(a){if(a!=correct_img){$('#email_notes').html(a);$('#email_result').html(wrong_img)}else{$('#email_notes').html('');$('#email_result').html(a)}})}else{$('#email_notes').html('');$('#email_result').html(wrong_img)}validate_form();break}});$('#country').change(function(){var b=$('input[name=MP_csrf]').val(),name='country',value=$(this).val();if(value==='1'||value==='2'){$.post("<?php echo site_url('registration/request'); ?>",{MP_csrf:b,name:name,value:value},function(a){$('#state').append(a)});$('#state').removeAttr('disabled')}validate_form()});$('#state').change(function(){validate_form()})});